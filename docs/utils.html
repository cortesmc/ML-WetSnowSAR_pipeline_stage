<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>utils package &mdash; Stage Wet Snow Benchmarking 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="evaluation package" href="evaluation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Stage Wet Snow Benchmarking
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="source/intro/index.html">SnowMark Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/installation_file/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/usage_files/index.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="estimators.html">estimators package</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluation.html">evaluation package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">utils package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-utils.SlidingWindowTransformer">utils.SlidingWindowTransformer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#slidingwindowtransformer">SlidingWindowTransformer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-utils.balance_management">utils.balance_management module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#balancemanagement">BalanceManagement</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-utils.dataset_load">utils.dataset_load module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasetloader">DatasetLoader</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-utils.dataset_management">utils.dataset_management module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-utils.figures">utils.figures module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-utils.files_management">utils.files_management module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-utils.fold_management">utils.fold_management module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-utils.geo_tools">utils.geo_tools module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-utils.image_processing">utils.image_processing module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-utils.label_management">utils.label_management module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#labelmanagement">LabelManagement</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-utils.metrics">utils.metrics module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-utils">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Stage Wet Snow Benchmarking</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">utils package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="utils-package">
<h1>utils package<a class="headerlink" href="#utils-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-utils.SlidingWindowTransformer">
<span id="utils-slidingwindowtransformer-module"></span><h2>utils.SlidingWindowTransformer module<a class="headerlink" href="#module-utils.SlidingWindowTransformer" title="Permalink to this heading"></a></h2>
<section id="slidingwindowtransformer">
<h3>SlidingWindowTransformer<a class="headerlink" href="#slidingwindowtransformer" title="Permalink to this heading"></a></h3>
<p>A transformer that applies a sliding window approach on a 3D array, allowing for block-wise processing using an estimator or a custom function.</p>
<dl class="py class">
<dt class="sig sig-object py" id="utils.SlidingWindowTransformer.SlidingWindowTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">utils.SlidingWindowTransformer.</span></span><span class="sig-name descname"><span class="pre">SlidingWindowTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_predict_proba</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/SlidingWindowTransformer.html#SlidingWindowTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.SlidingWindowTransformer.SlidingWindowTransformer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TransformerMixin</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.SlidingWindowTransformer.SlidingWindowTransformer.calculate_optimal_chunks">
<span class="sig-name descname"><span class="pre">calculate_optimal_chunks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/SlidingWindowTransformer.html#SlidingWindowTransformer.calculate_optimal_chunks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.SlidingWindowTransformer.SlidingWindowTransformer.calculate_optimal_chunks" title="Permalink to this definition"></a></dt>
<dd><p>Calculate optimal chunk sizes for Dask processing based on available memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>np.ndarray</em>) – Input data array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Optimal chunk sizes for Dask arrays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.SlidingWindowTransformer.SlidingWindowTransformer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/SlidingWindowTransformer.html#SlidingWindowTransformer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.SlidingWindowTransformer.SlidingWindowTransformer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fit the transformer to the data. No fitting process is required.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>np.ndarray</em>) – Input data, not used.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Target data, not used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Returns the instance itself.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#utils.SlidingWindowTransformer.SlidingWindowTransformer" title="utils.SlidingWindowTransformer.SlidingWindowTransformer">SlidingWindowTransformer</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.SlidingWindowTransformer.SlidingWindowTransformer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/SlidingWindowTransformer.html#SlidingWindowTransformer.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.SlidingWindowTransformer.SlidingWindowTransformer.transform" title="Permalink to this definition"></a></dt>
<dd><p>Transform the input data using the sliding window approach.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>np.ndarray</em>) – Input data to transform.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed output data after applying the sliding window and predictions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.SlidingWindowTransformer.SlidingWindowTransformer.transform_block">
<span class="sig-name descname"><span class="pre">transform_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/SlidingWindowTransformer.html#SlidingWindowTransformer.transform_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.SlidingWindowTransformer.SlidingWindowTransformer.transform_block" title="Permalink to this definition"></a></dt>
<dd><p>Transform a single block of data by applying the sliding window approach.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>block</strong> (<em>np.ndarray</em>) – A 3D block of data to be transformed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The predictions for each sliding window in the block.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the input block is not 3D.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="module-utils.balance_management">
<span id="utils-balance-management-module"></span><h2>utils.balance_management module<a class="headerlink" href="#module-utils.balance_management" title="Permalink to this heading"></a></h2>
<section id="balancemanagement">
<h3>BalanceManagement<a class="headerlink" href="#balancemanagement" title="Permalink to this heading"></a></h3>
<p>This module provides functionalities for balancing classes within folds using
various resampling methods, as well as creating balanced sub-folds for binary
or multi-label classification.</p>
<p>Other balancing methods can be added by creating a new function and adding the option to the balance_classes function with a new name.
The new balancing method must take a list of tuples and return a new list of tuples with training and test indices.</p>
<dl class="py class">
<dt class="sig sig-object py" id="utils.balance_management.BalanceManagement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">utils.balance_management.</span></span><span class="sig-name descname"><span class="pre">BalanceManagement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/balance_management.html#BalanceManagement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.balance_management.BalanceManagement" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.balance_management.BalanceManagement.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/balance_management.html#BalanceManagement.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.balance_management.BalanceManagement.transform" title="Permalink to this definition"></a></dt>
<dd><p>Balances the provided folds according to the specified method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folds</strong> (<em>list of tuples</em>) – A list containing train and test indices for each fold.</p></li>
<li><p><strong>targets</strong> (<em>np.ndarray</em>) – Target labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list containing balanced train and test indices for each fold.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.balance_management.bFold">
<span class="sig-prename descclassname"><span class="pre">utils.balance_management.</span></span><span class="sig-name descname"><span class="pre">bFold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/balance_management.html#bFold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.balance_management.bFold" title="Permalink to this definition"></a></dt>
<dd><p>Create balanced sub-folds for binary or multi-label classification within each main fold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folds</strong> (<em>list of tuples</em>) – A list containing train and test indices for each fold.</p></li>
<li><p><strong>targets</strong> (<em>np.ndarray</em>) – Target labels.</p></li>
<li><p><strong>rng</strong> (<em>int</em><em>, </em><em>optional</em>) – rng for random number generator. Default is 42.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list containing balanced train and test indices for each sub-fold.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.balance_management.bFold_multiclass">
<span class="sig-prename descclassname"><span class="pre">utils.balance_management.</span></span><span class="sig-name descname"><span class="pre">bFold_multiclass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/balance_management.html#bFold_multiclass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.balance_management.bFold_multiclass" title="Permalink to this definition"></a></dt>
<dd><p>Create balanced sub-folds for multi-label classification within each main fold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folds</strong> (<em>list of tuples</em>) – A list containing train and test indices for each fold.</p></li>
<li><p><strong>targets</strong> (<em>np.ndarray</em>) – Target labels.</p></li>
<li><p><strong>rng</strong> (<em>int</em><em>, </em><em>optional</em>) – rng for random number generator. Default is 42.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list containing balanced train and test indices for each sub-fold.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.balance_management.balance_classes">
<span class="sig-prename descclassname"><span class="pre">utils.balance_management.</span></span><span class="sig-name descname"><span class="pre">balance_classes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'oversample'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/balance_management.html#balance_classes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.balance_management.balance_classes" title="Permalink to this definition"></a></dt>
<dd><p>Balance the classes within each fold using the specified method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folds</strong> (<em>list of tuples</em>) – A list containing train and test indices for each fold.</p></li>
<li><p><strong>targets</strong> (<em>np.ndarray</em>) – Target labels.</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – The resampling method to use (‘oversample’, ‘undersample’, ‘smote’). Default is ‘oversample’.</p></li>
<li><p><strong>rng</strong> (<em>int</em><em>, </em><em>optional</em>) – rng for random number generator. Default is 42.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list containing balanced train and test indices for each fold.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the specified resampling method is not recognized.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-utils.dataset_load">
<span id="utils-dataset-load-module"></span><h2>utils.dataset_load module<a class="headerlink" href="#module-utils.dataset_load" title="Permalink to this heading"></a></h2>
<section id="datasetloader">
<h3>DatasetLoader<a class="headerlink" href="#datasetloader" title="Permalink to this heading"></a></h3>
<p>This module provides functions for obtaining data from the database file.</p>
<p>There are also several functions to help manage the main data set.</p>
<dl class="py class">
<dt class="sig sig-object py" id="utils.dataset_load.DatasetLoader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">utils.dataset_load.</span></span><span class="sig-name descname"><span class="pre">DatasetLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">descrp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['date',</span> <span class="pre">'massif',</span> <span class="pre">'aquisition',</span> <span class="pre">'elevation',</span> <span class="pre">'slope',</span> <span class="pre">'orientation',</span> <span class="pre">'tmin',</span> <span class="pre">'tel',</span> <span class="pre">'hsnow']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_load.html#DatasetLoader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_load.DatasetLoader" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.dataset_load.DatasetLoader.check_data">
<span class="sig-name descname"><span class="pre">check_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_load.html#DatasetLoader.check_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_load.DatasetLoader.check_data" title="Permalink to this definition"></a></dt>
<dd><p>Check if the dataset and the metadata have the same dimension</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.dataset_load.DatasetLoader.init_info">
<span class="sig-name descname"><span class="pre">init_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_load.html#DatasetLoader.init_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_load.DatasetLoader.init_info" title="Permalink to this definition"></a></dt>
<dd><p>Load the metadata and prepare the information for the request</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.dataset_load.DatasetLoader.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_load.html#DatasetLoader.load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_load.DatasetLoader.load_data" title="Permalink to this definition"></a></dt>
<dd><p>Load the dataset and the metadata with respect to the request and shuffle the data if needed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.dataset_load.DatasetLoader.request_data">
<span class="sig-name descname"><span class="pre">request_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">condition</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_load.html#DatasetLoader.request_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_load.DatasetLoader.request_data" title="Permalink to this definition"></a></dt>
<dd><p>Request the dataset with respect to the condition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>condition</strong> (<em>str</em>) – SQL like request to select the data in the pandas dataframe</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.dataset_load.load_data_h5">
<span class="sig-prename descclassname"><span class="pre">utils.dataset_load.</span></span><span class="sig-name descname"><span class="pre">load_data_h5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_load.html#load_data_h5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_load.load_data_h5" title="Permalink to this definition"></a></dt>
<dd><p>Load the dataset part of the hdf5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – path to the hdf5 file</p></li>
<li><p><strong>idx</strong> (<em>np.array</em><em>, </em><em>optional</em>) – index of the dataset to load, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dataset in float32</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.dataset_load.load_info_h5">
<span class="sig-prename descclassname"><span class="pre">utils.dataset_load.</span></span><span class="sig-name descname"><span class="pre">load_info_h5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'str'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_load.html#load_info_h5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_load.load_info_h5" title="Permalink to this definition"></a></dt>
<dd><p>Load the informations part of the hdf5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – path to the hdf5 file</p></li>
<li><p><strong>idx</strong> (<em>np.array</em><em>, </em><em>optional</em>) – index of the dataset to load, by default None</p></li>
<li><p><strong>type_metadata</strong> (<em>str</em><em>, </em><em>optional</em>) – type of the metadata, by default “str”
:info: for direct integer label, use “int”, for other type see numpy dtype</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>metadata in the type_metadata format</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.dataset_load.save_h5_II">
<span class="sig-prename descclassname"><span class="pre">utils.dataset_load.</span></span><span class="sig-name descname"><span class="pre">save_h5_II</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_load.html#save_h5_II"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_load.save_h5_II" title="Permalink to this definition"></a></dt>
<dd><p>Save data in hdf5 format with a data part (in float32),
a metadata part to describe data and two additional fields  (topography and physics)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>np.array</em>) – dataset to save (float32)</p></li>
<li><p><strong>y</strong> (<em>dict</em>) – dictionary of description of the dataset
:warning: the mandatory key is “metadata”, the other keys are optional</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – path to save the data</p></li>
<li><p><strong>additional_info</strong> (<em>bool</em><em>, </em><em>optional</em>) – give the possibility to save additional information (topography and physics), by default True</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.dataset_load.shuffle_data">
<span class="sig-prename descclassname"><span class="pre">utils.dataset_load.</span></span><span class="sig-name descname"><span class="pre">shuffle_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_load.html#shuffle_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_load.shuffle_data" title="Permalink to this definition"></a></dt>
<dd><p>Shuffle the dataset and the metadata</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>np.array</em>) – dataset</p></li>
<li><p><strong>y</strong> (<em>dict</em>) – dictionary of description of the dataset</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>np.array</em> – shuffled dataset</p></li>
<li><p><em>dict</em> – shuffled metadata</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-utils.dataset_management">
<span id="utils-dataset-management-module"></span><h2>utils.dataset_management module<a class="headerlink" href="#module-utils.dataset_management" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="utils.dataset_management.BFold">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">utils.dataset_management.</span></span><span class="sig-name descname"><span class="pre">BFold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_management.html#BFold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_management.BFold" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Balanced Fold cross-validator, only valid for binary classification.</p>
<p>Split dataset into k consecutive folds (without shuffling by default),
ensuring that each fold has the same number of samples from each class.
It allows to have B sub-datasets balanced, and have a complete view of the
data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to shuffle the data before splitting into batches.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>RandomState instance</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – When shuffle=True, pseudo-random number generator state used for
shuffling. If None, use default numpy RNG for shuffling.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="utils.dataset_management.BFold.n_splits">
<span class="sig-name descname"><span class="pre">n_splits</span></span><a class="headerlink" href="#utils.dataset_management.BFold.n_splits" title="Permalink to this definition"></a></dt>
<dd><p>Returns the number of splitting iterations in the cross-validator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.dataset_management.BFold.get_n_splits">
<span class="sig-name descname"><span class="pre">get_n_splits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_management.html#BFold.get_n_splits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_management.BFold.get_n_splits" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.dataset_management.BFold.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_management.html#BFold.split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_management.BFold.split" title="Permalink to this definition"></a></dt>
<dd><p>Generate indices to split data into training set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>numpy array</em>) – dataset of images</p></li>
<li><p><strong>y</strong> (<em>numpy array</em>) – dataset of labels        test : numpy array
The testing set indices for that split.</p></li>
<li><p><strong>------</strong> – </p></li>
<li><p><strong>train</strong> (<em>numpy array</em>) – The training set indices for that split.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.dataset_management.balance_dataset">
<span class="sig-prename descclassname"><span class="pre">utils.dataset_management.</span></span><span class="sig-name descname"><span class="pre">balance_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_management.html#balance_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_management.balance_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Balance the dataset by taking the minimum number of samples per class (under-sampling)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>numpy array</em>) – dataset of images in float32, shape (n_samples, height, width, n_bands)</p></li>
<li><p><strong>Y</strong> (<em>numpy array</em>) – dataset of labels in string, shape (n_samples,)</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>optional</em>) – Shuffle the dataset, by default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>numpy array</em> – balanced dataset of images in float32, shape (n_samples, height, width, n_bands)</p></li>
<li><p><em>numpy array</em> – balanced dataset of labels in string, shape (n_samples,)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.dataset_management.balance_dataset_with_imblearn">
<span class="sig-prename descclassname"><span class="pre">utils.dataset_management.</span></span><span class="sig-name descname"><span class="pre">balance_dataset_with_imblearn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'under'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_management.html#balance_dataset_with_imblearn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_management.balance_dataset_with_imblearn" title="Permalink to this definition"></a></dt>
<dd><p>Balance the dataset using specified method (under-sampling, over-sampling, or combined)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>numpy array</em>) – dataset of images in float32, shape (n_samples, height, width, n_bands)</p></li>
<li><p><strong>Y</strong> (<em>numpy array</em>) – dataset of labels in string, shape (n_samples,)</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Method to balance the dataset, ‘under’ for under-sampling, ‘over’ for over-sampling,
and ‘combine’ for a combination of over- and under-sampling, by default ‘under’</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>optional</em>) – Shuffle the dataset, by default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>numpy array</em> – balanced dataset of images in float32, shape (n_samples, height, width, n_bands)</p></li>
<li><p><em>numpy array</em> – balanced dataset of labels in string, shape (n_samples,)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.dataset_management.load_test">
<span class="sig-prename descclassname"><span class="pre">utils.dataset_management.</span></span><span class="sig-name descname"><span class="pre">load_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">balanced</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_management.html#load_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_management.load_test" title="Permalink to this definition"></a></dt>
<dd><p>Load a hdf5 file containing the testing dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i_path</strong> (<em>str</em>) – Path to the hdf5 file with name “data_test.h5”</p></li>
<li><p><strong>bands_max</strong> (<em>list</em>) – List of bands to keep in the dataset</p></li>
<li><p><strong>balanced</strong> (<em>bool</em>) – If True, the dataset is balanced</p></li>
<li><p><strong>shffle</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the dataset is shuffled (rng 42), by default True</p></li>
<li><p><strong>encoder</strong> (<em>sklearn.preprocessing.LabelEncoder</em><em>, </em><em>optional</em>) – Encoder used to encode the labels, by default None
The encoder must be fitted before ie using the <cite>load_train</cite> function</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>numpy array</em> – Dataset of images in float32, shape (n_samples, height, width, n_bands)</p></li>
<li><p><em>numpy array</em> – Dataset of labels in string, shape (n_samples,)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.dataset_management.load_train">
<span class="sig-prename descclassname"><span class="pre">utils.dataset_management.</span></span><span class="sig-name descname"><span class="pre">load_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">balanced</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_management.html#load_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_management.load_train" title="Permalink to this definition"></a></dt>
<dd><p>Load a hdf5 file containing the training dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i_path</strong> (<em>str</em>) – Path to the hdf5 file with name “data_train.h5”</p></li>
<li><p><strong>bands_max</strong> (<em>list</em>) – List of bands to keep in the dataset</p></li>
<li><p><strong>balanced</strong> (<em>bool</em>) – If True, the dataset is balanced</p></li>
<li><p><strong>shffle</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the dataset is shuffled (rng 42), by default True</p></li>
<li><p><strong>encode</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the labels are encoded, by default True</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>numpy array</em> – Dataset of images in float32, shape (n_samples, height, width, n_bands)</p></li>
<li><p><em>numpy array</em> – Dataset of labels in string, shape (n_samples,)</p></li>
<li><p><em>sklearn.preprocessing.LabelEncoder</em> – Encoder used to encode the labels</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.dataset_management.parse_pipeline">
<span class="sig-prename descclassname"><span class="pre">utils.dataset_management.</span></span><span class="sig-name descname"><span class="pre">parse_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_management.html#parse_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_management.parse_pipeline" title="Permalink to this definition"></a></dt>
<dd><p>Parse a dictionary to create a pipeline of estimators
The dictionary must have the following structure::
{</p>
<blockquote>
<div><dl class="simple">
<dt>“import”: [</dt><dd><p>“from sklearn.preprocessing import StandardScaler”,
“from sklearn.decomposition import PCA”,
“from sklearn.svm import SVC”,</p>
</dd>
</dl>
<p>],
“pipeline”: [</p>
<blockquote>
<div><dl class="simple">
<dt>[</dt><dd><p>[“StandardScaler”, {“with_mean”: False, “with_std”: False}],
[“PCA”, {“n_components”: 0.95}],
[“SVC”, {“kernel”: “rbf”, “C”: 10, “gamma”: 0.01}],</p>
</dd>
</dl>
<p>]</p>
</div></blockquote>
<p>],</p>
</div></blockquote>
<p>}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>Namespace</em>) – Namespace object containing the pipeline</p></li>
<li><p><strong>idx</strong> (<em>int</em>) – Index of the pipeline to use in case of multiple pipelines</p></li>
<li><p><strong>rng</strong> (<em>int</em><em>, </em><em>optional</em>) – Random state to set for estimators that support it.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pipeline of estimators</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sklearn.pipeline.Pipeline</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.dataset_management.random_shuffle">
<span class="sig-prename descclassname"><span class="pre">utils.dataset_management.</span></span><span class="sig-name descname"><span class="pre">random_shuffle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dataset_management.html#random_shuffle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dataset_management.random_shuffle" title="Permalink to this definition"></a></dt>
<dd><p>Shuffle randomly the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>numpy array</em>) – dataset of images</p></li>
<li><p><strong>y</strong> (<em>numpy array</em>) – dataset of labels</p></li>
<li><p><strong>rng</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed, by default -1, must be a np.random.default_rng() object</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>numpy array</em> – shuffled dataset of images</p></li>
<li><p><em>numpy array</em> – shuffled dataset of labels</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-utils.figures">
<span id="utils-figures-module"></span><h2>utils.figures module<a class="headerlink" href="#module-utils.figures" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="utils.figures.plot_boxplots">
<span class="sig-prename descclassname"><span class="pre">utils.figures.</span></span><span class="sig-name descname"><span class="pre">plot_boxplots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_to_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fold_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_massives</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/figures.html#plot_boxplots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.figures.plot_boxplots" title="Permalink to this definition"></a></dt>
<dd><p>Create and save boxplots for specified metrics by model and by fold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics_dict</strong> (<em>dict</em>) – A dictionary containing various computed metrics for multiple models.</p></li>
<li><p><strong>metrics_to_plot</strong> (<em>list</em><em>, </em><em>optional</em>) – List of metrics to be plotted. If empty, all metrics are plotted.</p></li>
<li><p><strong>save_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Directory where the plots will be saved. If None, plots are not saved.</p></li>
<li><p><strong>fold_key</strong> (<em>dict</em><em>, </em><em>optional</em>) – Mapping of fold identifiers to more descriptive names, used if <cite>labels_massives</cite> is True.</p></li>
<li><p><strong>labels_massives</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, uses descriptive names from <cite>fold_key</cite> for the x-axis labels in fold plots.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.figures.plot_roc_curves">
<span class="sig-prename descclassname"><span class="pre">utils.figures.</span></span><span class="sig-name descname"><span class="pre">plot_roc_curves</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/figures.html#plot_roc_curves"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.figures.plot_roc_curves" title="Permalink to this definition"></a></dt>
<dd><p>Generate and save ROC curves for each model in the provided dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>models_dict</strong> (<em>dict</em>) – A dictionary where keys are model names and values are lists of dictionaries
containing ‘y_true’ and ‘y_pred’ for each fold.</p></li>
<li><p><strong>save_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Directory where the plots will be saved. If None, plots will not be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-utils.files_management">
<span id="utils-files-management-module"></span><h2>utils.files_management module<a class="headerlink" href="#module-utils.files_management" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.check_and_create_directory">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">check_and_create_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#check_and_create_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.check_and_create_directory" title="Permalink to this definition"></a></dt>
<dd><p>Check if a directory exists, and create it if it does not.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> (<em>str</em>) – Path to the directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to the directory.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.clean_log">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">clean_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#clean_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.clean_log" title="Permalink to this definition"></a></dt>
<dd><p>Clean a log file to remove extraneous information for better readability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>log</strong> (<em>list</em>) – The list of lines from the log file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The cleaned log lines.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.compresser_en_zip">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">compresser_en_zip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chemin_dossier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chemin_zip</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#compresser_en_zip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.compresser_en_zip" title="Permalink to this definition"></a></dt>
<dd><p>Compress a directory in a zip file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chemin_dossier</strong> (<em>str</em>) – Path to the directory to compress.</p></li>
<li><p><strong>chemin_zip</strong> (<em>str</em>) – Path to the zip file to create.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1 if the compression is successful.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.dump_h5">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">dump_h5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#dump_h5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.dump_h5" title="Permalink to this definition"></a></dt>
<dd><p>Dump data to an HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – The data to store.</p></li>
<li><p><strong>file_path</strong> (<em>str</em>) – The path to the HDF5 file.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.dump_pkl">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">dump_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#dump_pkl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.dump_pkl" title="Permalink to this definition"></a></dt>
<dd><p>Dump object in pickle file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> (<em>object</em>) – Object to dump, can be a list, a dict, a numpy array, etc.</p></li>
<li><p><strong>path</strong> (<em>str</em>) – Path to the pickle file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1 if the dump is successful.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.extract_zip">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">extract_zip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chemin_zip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chemin_extraction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#extract_zip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.extract_zip" title="Permalink to this definition"></a></dt>
<dd><p>Extract a zip file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chemin_zip</strong> (<em>str</em>) – Path to the zip file to extract.</p></li>
<li><p><strong>chemin_extraction</strong> (<em>str</em>) – Path to the directory where the zip file will be extracted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1 if the extraction is successful.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.init_logger">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">init_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#init_logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.init_logger" title="Permalink to this definition"></a></dt>
<dd><p>Initialize a logger for recording activities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_log</strong> (<em>str</em>) – Path to the log file.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – Name of the logger instance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(Logger instance, path to the log file).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.load_h5">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">load_h5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#load_h5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.load_h5" title="Permalink to this definition"></a></dt>
<dd><p>Load data from an HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>str</em>) – The path to the HDF5 file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The loaded data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.load_yaml">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">load_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#load_yaml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.load_yaml" title="Permalink to this definition"></a></dt>
<dd><p>Load a yaml file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_name</strong> (<em>str</em>) – Path to the yaml file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.logger_dataset">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">logger_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#logger_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.logger_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Log detailed information about the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logg</strong> (<em>logging.Logger</em>) – Logger instance for reporting.</p></li>
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – Input features.</p></li>
<li><p><strong>metadata</strong> (<em>dict</em>) – Metadata containing additional dataset information.</p></li>
<li><p><strong>targets</strong> (<em>numpy.ndarray</em>) – Target labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Logger instance with dataset information logged.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>logging.Logger</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.logger_fold">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">logger_fold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fold_groups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#logger_fold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.logger_fold" title="Permalink to this definition"></a></dt>
<dd><p>Log information about each fold in cross-validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logg</strong> (<em>logging.Logger</em>) – Logger instance.</p></li>
<li><p><strong>fold_groups</strong> (<em>list of tuples</em>) – List of (train_index, test_index) tuples for each fold.</p></li>
<li><p><strong>targets</strong> (<em>numpy.ndarray</em>) – Target labels.</p></li>
<li><p><strong>metadata</strong> (<em>dict</em>) – Metadata dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(Logger instance, dictionary containing massif information for each fold).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.open_log_file">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">open_log_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#open_log_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.open_log_file" title="Permalink to this definition"></a></dt>
<dd><p>Open a log file (.log) and return its contents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path_log</strong> (<em>str</em>) – The path to the log file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of lines from the log file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.open_param_set_dir">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">open_param_set_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_path_param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#open_param_set_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.open_param_set_dir" title="Permalink to this definition"></a></dt>
<dd><p>Create a directory to save the results of the model with the parameter file used.
The directory is named with the date and time of the execution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i_path_param</strong> (<em>str</em>) – Path to the parameter file used.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Path to the output directory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to the directory created.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.open_pkl">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">open_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#open_pkl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.open_pkl" title="Permalink to this definition"></a></dt>
<dd><p>Open pickle file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Path to the pickle file to open.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Object contained in the pickle file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.report_metric_from_log">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">report_metric_from_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_to_report</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['f1_score_weighted']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#report_metric_from_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.report_metric_from_log" title="Permalink to this definition"></a></dt>
<dd><p>Report metrics from a dictionary of model scores.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logg</strong> (<em>logging.Logger</em>) – Logger instance to log the metrics.</p></li>
<li><p><strong>dic</strong> (<em>dict</em>) – Dictionary containing metrics for each model.</p></li>
<li><p><strong>metrics_to_report</strong> (<em>list</em><em>, </em><em>optional</em>) – List of metrics to report, by default includes ‘f1_score_weighted’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The logger instance with reported metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>logging.Logger</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.report_prediction">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">report_prediction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">le</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fold</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#report_prediction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.report_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Compute and log various classification metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>numpy.ndarray</em>) – True labels (categorical or binary).</p></li>
<li><p><strong>y_pred</strong> (<em>numpy.ndarray</em>) – Predicted probabilities or classes.</p></li>
<li><p><strong>le</strong> (<em>LabelEncoder</em>) – LabelEncoder object for inverse transforming labels.</p></li>
<li><p><strong>logg</strong> (<em>logging.Logger</em>) – Logger instance for reporting.</p></li>
<li><p><strong>fold</strong> (<em>int</em>) – Fold number for identification.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(Logger instance, dictionary of computed metrics).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.save_h5">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">save_h5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#save_h5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.save_h5" title="Permalink to this definition"></a></dt>
<dd><p>Save image and label in a hdf5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>numpy.ndarray</em>) – Dataset of images in float32.</p></li>
<li><p><strong>label</strong> (<em>numpy.ndarray</em>) – Dataset of labels in string.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Path to the hdf5 file.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.save_metrics">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">save_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fold_metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#save_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.save_metrics" title="Permalink to this definition"></a></dt>
<dd><p>Log the metrics for each fold of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_model</strong> (<em>logging.Logger</em>) – Logger instance.</p></li>
<li><p><strong>fold_metric</strong> (<em>list of dict</em>) – List of metrics for each fold.</p></li>
<li><p><strong>model_name</strong> (<em>str</em>) – Name of the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Logger instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>logging.Logger</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.save_yaml">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">save_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#save_yaml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.save_yaml" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.set_folder">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">set_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#set_folder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.set_folder" title="Permalink to this definition"></a></dt>
<dd><p>Create and organize folders for the study.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dir</strong> (<em>str</em>) – Path to the base output directory.</p></li>
<li><p><strong>args</strong> (<em>dict</em>) – Dictionary containing pipeline parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to the organized study folder.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.files_management.write_report">
<span class="sig-prename descclassname"><span class="pre">utils.files_management.</span></span><span class="sig-name descname"><span class="pre">write_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_report</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/files_management.html#write_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.files_management.write_report" title="Permalink to this definition"></a></dt>
<dd><p>Write a txt report from a log file (.log).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_log</strong> (<em>str</em>) – Path to the log file.</p></li>
<li><p><strong>path_report</strong> (<em>str</em>) – Path to the report file.</p></li>
<li><p><strong>begin_line</strong> (<em>int</em><em>, </em><em>optional</em>) – Line number to start the report, by default 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>list</em> – List of lines in the log file without useless information.</p></li>
<li><p><em>int</em> – Number of lines in the log file.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-utils.fold_management">
<span id="utils-fold-management-module"></span><h2>utils.fold_management module<a class="headerlink" href="#module-utils.fold_management" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="utils.fold_management.FoldManagement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">utils.fold_management.</span></span><span class="sig-name descname"><span class="pre">FoldManagement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kFold'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_aprox_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/fold_management.html#FoldManagement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.fold_management.FoldManagement" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.fold_management.FoldManagement.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/fold_management.html#FoldManagement.split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.fold_management.FoldManagement.split" title="Permalink to this definition"></a></dt>
<dd><p>Split the data into train and test sets based on the specified folding method.</p>
<p>The method combinationFold takes the variable: “proximity_value”; which is a value to control the proximity of the distribution of the folds.</p>
<p>Parameters:
- x : array-like</p>
<blockquote>
<div><p>The data to split.</p>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>y<span class="classifier">dict</span></dt><dd><p>The metadata associated with the data.</p>
</dd>
</dl>
</li>
</ul>
<p>Returns:
- list of tuples</p>
<blockquote>
<div><p>Generator like list.</p>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.fold_management.KFold_method">
<span class="sig-prename descclassname"><span class="pre">utils.fold_management.</span></span><span class="sig-name descname"><span class="pre">KFold_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/fold_management.html#KFold_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.fold_management.KFold_method" title="Permalink to this definition"></a></dt>
<dd><p>Perform K-Fold cross-validation on the data.</p>
<p>Parameters:
- x : array-like</p>
<blockquote>
<div><p>The data to split into K folds.</p>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>train_size<span class="classifier">float, optional (default=0.8)</span></dt><dd><p>The proportion of the dataset to include in the train split.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>rng<span class="classifier">int or None, optional (default=None)</span></dt><dd><p>rng used by the random number generator for reproducibility. If None, a random rng will be selected.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>shuffle<span class="classifier">bool, optional (default=False)</span></dt><dd><p>Whether to shuffle the data before splitting into folds.</p>
</dd>
</dl>
</li>
</ul>
<p>Returns:
- list of tuples</p>
<blockquote>
<div><p>A list containing train and test indices for each fold.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.fold_management.combination_method">
<span class="sig-prename descclassname"><span class="pre">utils.fold_management.</span></span><span class="sig-name descname"><span class="pre">combination_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_massives</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proximity_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/fold_management.html#combination_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.fold_management.combination_method" title="Permalink to this definition"></a></dt>
<dd><p>Generate prioritized combinations of massives based on a given dictionary.</p>
<p>Parameters:
- dict_massives : dict</p>
<blockquote>
<div><p>A dictionary where keys are massives and values are dictionaries containing ‘count’ and ‘indices’ keys.
Example: {</p>
<blockquote>
<div><p>‘massif1’: {‘count’: 10, ‘indices’: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]},
‘massif2’: {‘count’: 5, ‘indices’: [10, 11, 12, 13, 14]},
…</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>train_size<span class="classifier">float, optional (default=0.8)</span></dt><dd><p>The proportion of the dataset to include in the train split.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>proximity_value<span class="classifier">int, optional (default=1)</span></dt><dd><p>A value to control the proximity to the desired train size.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>shuffle<span class="classifier">bool, optional (default=False)</span></dt><dd><p>Whether to shuffle the selection of combinations.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>rng<span class="classifier">int, optional (default=None)</span></dt><dd><p>rng for random number generator (used if shuffle is True).</p>
</dd>
</dl>
</li>
</ul>
<p>Returns:
- list of tuples</p>
<blockquote>
<div><p>A list containing train and test indices for each prioritized combination of massives.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.fold_management.fold_massive_method">
<span class="sig-prename descclassname"><span class="pre">utils.fold_management.</span></span><span class="sig-name descname"><span class="pre">fold_massive_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_massives</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/fold_management.html#fold_massive_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.fold_management.fold_massive_method" title="Permalink to this definition"></a></dt>
<dd><p>Generate train and test indices for each massive in a dictionary.</p>
<p>Parameters:
- dict_massives : dict</p>
<blockquote>
<div><p>A dictionary where keys are massives and values are dictionaries containing ‘count’ and ‘indices’ keys.</p>
</div></blockquote>
<p>Returns:
- list of tuples</p>
<blockquote>
<div><p>A list containing train and test indices for each massive.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.fold_management.simple_split">
<span class="sig-prename descclassname"><span class="pre">utils.fold_management.</span></span><span class="sig-name descname"><span class="pre">simple_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/fold_management.html#simple_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.fold_management.simple_split" title="Permalink to this definition"></a></dt>
<dd><p>Perform a simple split of the data into training and testing sets.</p>
<p>Parameters:
- x : array-like</p>
<blockquote>
<div><p>The data to split.</p>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>train_size<span class="classifier">float, optional (default=0.8)</span></dt><dd><p>The proportion of the dataset to include in the training split.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>rng<span class="classifier">int or None, optional (default=None)</span></dt><dd><p>rng used by the random number generator for reproducibility.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>shuffle<span class="classifier">bool, optional (default=False)</span></dt><dd><p>Whether to shuffle the data before splitting.</p>
</dd>
</dl>
</li>
</ul>
<p>Returns:
- tuple</p>
<blockquote>
<div><p>A tuple containing train and test indices.</p>
</div></blockquote>
</dd></dl>

</section>
<section id="module-utils.geo_tools">
<span id="utils-geo-tools-module"></span><h2>utils.geo_tools module<a class="headerlink" href="#module-utils.geo_tools" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="utils.geo_tools.array2raster">
<span class="sig-prename descclassname"><span class="pre">utils.geo_tools.</span></span><span class="sig-name descname"><span class="pre">array2raster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geodata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdal_driver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/geo_tools.html#array2raster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.geo_tools.array2raster" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Converts a numpy array to a specific geospatial output
If you provide the geodata of the original input dataset, then the output array will match this exactly.
If you’ve changed any extents/cell sizes, then you need to amend the geodata variable contents (see below)</p>
<dl class="simple">
<dt>data_array<span class="classifier">numpy array</span></dt><dd><p>The data as a numpy array</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>geodata<span class="classifier">tuple</span></dt><dd><blockquote>
<div><p>(geotransform, inDs) # this is a combined variable of components when you opened the dataset</p>
</div></blockquote>
<dl class="simple">
<dt>file_out<span class="classifier">str</span></dt><dd><p>The file name of the output data</p>
</dd>
<dt>gdal_driver<span class="classifier">str</span></dt><dd><p>The gdal driver to use to write out the data (default is geotif) - see: <a class="reference external" href="http://www.gdal.org/formats_list.html">http://www.gdal.org/formats_list.html</a></p>
</dd>
</dl>
<p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.geo_tools.calculate_E_distribution">
<span class="sig-prename descclassname"><span class="pre">utils.geo_tools.</span></span><span class="sig-name descname"><span class="pre">calculate_E_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alti_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alti_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/geo_tools.html#calculate_E_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.geo_tools.calculate_E_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the distribution of the prediction map for a given elevation range</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction</strong> (<em>numpy array</em>) – prediction map (between 0 and 1)</p></li>
<li><p><strong>dem</strong> (<em>numpy array</em>) – digital elevation model: elevation in meters</p></li>
<li><p><strong>alti_min</strong> (<em>float</em>) – minimum elevation in meters to consider</p></li>
<li><p><strong>alti_max</strong> (<em>float</em>) – maximum elevation in meters to consider</p></li>
<li><p><strong>step</strong> (<em>float</em>) – step in meters to consider</p></li>
<li><p><strong>condition</strong> (<em>numpy array</em>) – boolean array of the same shape as dem</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>alti</strong> – distribution of the prediction map over the elevation range</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.geo_tools.calculate_OE_distribution">
<span class="sig-prename descclassname"><span class="pre">utils.geo_tools.</span></span><span class="sig-name descname"><span class="pre">calculate_OE_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alti_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alti_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cond_pente</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/geo_tools.html#calculate_OE_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.geo_tools.calculate_OE_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the distribution of the prediction map for a given orientation range
and elevation range</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction</strong> (<em>numpy array</em>) – prediction map (between 0 and 1)</p></li>
<li><p><strong>theta</strong> (<em>numpy array</em>) – orientation map in degrees</p></li>
<li><p><strong>dem</strong> (<em>numpy array</em>) – digital elevation model: elevation in meters</p></li>
<li><p><strong>orientation</strong> (<em>numpy array</em>) – array of the orientation range in degrees</p></li>
<li><p><strong>alti_min</strong> (<em>float</em>) – minimum elevation in meters to consider</p></li>
<li><p><strong>alti_max</strong> (<em>float</em>) – maximum elevation in meters to consider</p></li>
<li><p><strong>step</strong> (<em>float</em>) – step in meters to consider</p></li>
<li><p><strong>cond_pente</strong> (<em>numpy array</em>) – boolean array of the same shape as dem</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>alti_theta</strong> – distribution of the prediction map over the orientation range and elevation range</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.geo_tools.calculate_SOE_distribution">
<span class="sig-prename descclassname"><span class="pre">utils.geo_tools.</span></span><span class="sig-name descname"><span class="pre">calculate_SOE_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pente</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alti_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alti_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/geo_tools.html#calculate_SOE_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.geo_tools.calculate_SOE_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the distribution of the prediction map for a given orientation range,
elevation range and slope range using step.
For example if you want to the number of pixels with a slope between 0 and 5 degrees,
a orientation between 0 and 22.5 degrees and an elevation between 0 and 100 meters.</p>
<p>Example::
prediction = np.random.rand(500, 500)
dem = np.random.rand(500, 500) * 4000
gradient = np.random.rand(500, 500) * 90
theta = np.random.rand(500, 500) * 360
pente = [22.5]
step_alt = 50
step_or = 22.5 / 2
alti_max = dem.max()
alti_min = dem[dem &gt; 0].min() - step_alt
orientation = np.arange(-step_or, 360, step_or) % 360
alpeor_II = calculate_SOE_distribution(</p>
<blockquote>
<div><p>prediction, gradient, dem, theta, orientation, pente, alti_min, alti_max, step_alt</p>
</div></blockquote>
<p>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction</strong> (<em>numpy array</em>) – prediction map (between 0 and 1)</p></li>
<li><p><strong>gradient</strong> (<em>numpy array</em>) – slope map in degrees</p></li>
<li><p><strong>dem</strong> (<em>numpy array</em>) – digital elevation model: elevation in meters</p></li>
<li><p><strong>theta</strong> (<em>numpy array</em>) – orientation map in degrees</p></li>
<li><p><strong>orientation</strong> (<em>numpy array</em>) – array of the orientation range in degrees</p></li>
<li><p><strong>pente</strong> (<em>numpy array</em>) – array of the slope range in degrees</p></li>
<li><p><strong>alti_min</strong> (<em>float</em>) – minimum elevation in meters to consider</p></li>
<li><p><strong>alti_max</strong> (<em>float</em>) – maximum elevation in meters to consider</p></li>
<li><p><strong>step</strong> (<em>float</em>) – step in meters to consider</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>alpeor</strong> – distribution of the prediction map over the orientation range, elevation range and slope range</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.geo_tools.load_data">
<span class="sig-prename descclassname"><span class="pre">utils.geo_tools.</span></span><span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdal_driver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/geo_tools.html#load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.geo_tools.load_data" title="Permalink to this definition"></a></dt>
<dd><p>Converts a GDAL compatable file into a numpy array and associated geodata.
The rray is provided so you can run with your processing - the geodata consists of the geotransform and gdal dataset object
If you’re using an ENVI binary as input, this willr equire an associated .hdr file otherwise this will fail.
This needs modifying if you’re dealing with multiple bands.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<em>str</em>) – The file name of the input data</p></li>
<li><p><strong>gdal_driver</strong> (<em>str</em>) – The gdal driver to use to read the data (default is geotif) - see: <a class="reference external" href="http://www.gdal.org/formats_list.html">http://www.gdal.org/formats_list.html</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>image_array</strong> (<em>numpy array</em>) – The data as a numpy array</p></li>
<li><p><strong>geodata</strong> (<em>tuple</em>) – (geotransform, inDs) # this is a combined variable of components when you opened the dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-utils.image_processing">
<span id="utils-image-processing-module"></span><h2>utils.image_processing module<a class="headerlink" href="#module-utils.image_processing" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="utils.image_processing.Patch_extractor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">utils.image_processing.</span></span><span class="sig-name descname"><span class="pre">Patch_extractor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/image_processing.html#Patch_extractor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.image_processing.Patch_extractor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for managing the extraction of overlapping patches from an image
and the reconstruction of the image from the patches.
It is based on the scikit-learn class
sklearn.feature_extraction.image.extract_patches_2d
For the reconstruction, in case of odd window size, the center pixel
of the patch is selected as the center pixel of the patch. In case of even
window size, the upper left pixel in the center is selected as the center
pixel of the patch.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="utils.image_processing.Patch_extractor.window_size">
<span class="sig-name descname"><span class="pre">window_size</span></span><a class="headerlink" href="#utils.image_processing.Patch_extractor.window_size" title="Permalink to this definition"></a></dt>
<dd><p>Size of the window (square)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="utils.image_processing.Patch_extractor.channel">
<span class="sig-name descname"><span class="pre">channel</span></span><a class="headerlink" href="#utils.image_processing.Patch_extractor.channel" title="Permalink to this definition"></a></dt>
<dd><p>Channel to extract</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="utils.image_processing.Patch_extractor.padding">
<span class="sig-name descname"><span class="pre">padding</span></span><a class="headerlink" href="#utils.image_processing.Patch_extractor.padding" title="Permalink to this definition"></a></dt>
<dd><p>Perform padding on the image before extracting patches</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="utils.image_processing.Patch_extractor.positions_">
<span class="sig-name descname"><span class="pre">positions_</span></span><a class="headerlink" href="#utils.image_processing.Patch_extractor.positions_" title="Permalink to this definition"></a></dt>
<dd><p>Array of positions corresponding to the extracted patches</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="utils.image_processing.Patch_extractor.patches">
<span class="sig-name descname"><span class="pre">patches</span></span><a class="headerlink" href="#utils.image_processing.Patch_extractor.patches" title="Permalink to this definition"></a></dt>
<dd><p>Array of extracted patches</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="utils.image_processing.Patch_extractor.image_size">
<span class="sig-name descname"><span class="pre">image_size</span></span><a class="headerlink" href="#utils.image_processing.Patch_extractor.image_size" title="Permalink to this definition"></a></dt>
<dd><p>Size of the original image (Nx, Ny, C)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.image_processing.Patch_extractor.extract">
<span class="sig-name descname"><span class="pre">extract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/image_processing.html#Patch_extractor.extract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.image_processing.Patch_extractor.extract" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.image_processing.Patch_extractor.reconstruct">
<span class="sig-name descname"><span class="pre">reconstruct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/image_processing.html#Patch_extractor.reconstruct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.image_processing.Patch_extractor.reconstruct" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.image_processing.create_position_matrix">
<span class="sig-prename descclassname"><span class="pre">utils.image_processing.</span></span><span class="sig-name descname"><span class="pre">create_position_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/image_processing.html#create_position_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.image_processing.create_position_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Create a position matrix for an image of size Nx, Ny</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>image_size</strong> (<em>tuple</em>) – Size of the image (Nx, Ny)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Position matrix of size Nx, Ny, 2</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.image_processing.pad_image">
<span class="sig-prename descclassname"><span class="pre">utils.image_processing.</span></span><span class="sig-name descname"><span class="pre">pad_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/image_processing.html#pad_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.image_processing.pad_image" title="Permalink to this definition"></a></dt>
<dd><p>Perform padding on an image to enable extraction of windows of size W x W</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>numpy array</em>) – Image of dimension Nx, Ny, C</p></li>
<li><p><strong>window_size</strong> (<em>int</em>) – Size of the windows (square)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Padded image</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.image_processing.reconstruct_image_from_data">
<span class="sig-prename descclassname"><span class="pre">utils.image_processing.</span></span><span class="sig-name descname"><span class="pre">reconstruct_image_from_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/image_processing.html#reconstruct_image_from_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.image_processing.reconstruct_image_from_data" title="Permalink to this definition"></a></dt>
<dd><p>Reconstruct the original image from data and positions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy array</em>) – Array of data</p></li>
<li><p><strong>positions</strong> (<em>numpy array</em>) – Array of positions corresponding to the data</p></li>
<li><p><strong>image_size</strong> (<em>tuple</em>) – Size of the original image (Nx, Ny, C)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reconstructed image</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.image_processing.scale_data">
<span class="sig-prename descclassname"><span class="pre">utils.image_processing.</span></span><span class="sig-name descname"><span class="pre">scale_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">999</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/image_processing.html#scale_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.image_processing.scale_data" title="Permalink to this definition"></a></dt>
<dd><p>scale data between 0 and 1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>np.array</em>) – image to scale of shape (…, C), where C is the number of channels
must the last dimension</p></li>
<li><p><strong>axes</strong> (<em>list</em><em>, </em><em>optional</em>) – axes to use for scaling, by default None
None means all axes except the last one (channels) is used</p></li>
<li><p><strong>no_data</strong> (<em>int</em><em>, </em><em>optional</em>) – value to ignore, by default -999
and replace by np.nan, it should be the minimum value of the image</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>scaled image</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-utils.label_management">
<span id="utils-label-management-module"></span><h2>utils.label_management module<a class="headerlink" href="#module-utils.label_management" title="Permalink to this heading"></a></h2>
<section id="labelmanagement">
<h3>LabelManagement<a class="headerlink" href="#labelmanagement" title="Permalink to this heading"></a></h3>
<p>This module provides functionalities for labeling data based on specific conditions,
including methods for single and multi-label classification.</p>
<p>Other labeling methods can be added by creating a new function and adding the option to the transform function with a new name.
The new labeling method method must take the dictionary with the metadata and return a new list of the labels.</p>
<dl class="py class">
<dt class="sig sig-object py" id="utils.label_management.LabelManagement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">utils.label_management.</span></span><span class="sig-name descname"><span class="pre">LabelManagement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/label_management.html#LabelManagement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.label_management.LabelManagement" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.label_management.LabelManagement.get_encoder">
<span class="sig-name descname"><span class="pre">get_encoder</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/label_management.html#LabelManagement.get_encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.label_management.LabelManagement.get_encoder" title="Permalink to this definition"></a></dt>
<dd><p>Return the LabelEncoder instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.label_management.LabelManagement.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/label_management.html#LabelManagement.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.label_management.LabelManagement.transform" title="Permalink to this definition"></a></dt>
<dd><p>Apply the selected labeling method to the provided metadata.</p>
<p>Parameters:
- metadata : dict</p>
<blockquote>
<div><p>A dictionary containing metadata.</p>
</div></blockquote>
<p>Returns:
- labels_encoded : ndarray</p>
<blockquote>
<div><p>An array of encoded labels.</p>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.label_management.crocus_method">
<span class="sig-prename descclassname"><span class="pre">utils.label_management.</span></span><span class="sig-name descname"><span class="pre">crocus_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/label_management.html#crocus_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.label_management.crocus_method" title="Permalink to this definition"></a></dt>
<dd><p>Apply the crocus method to label data based on specific conditions.</p>
<p>Parameters:
- metadata : dict</p>
<blockquote>
<div><p>A dictionary containing metadata. Must include a ‘physics’ key with corresponding data.</p>
</div></blockquote>
<p>Returns:
- labels : ndarray</p>
<blockquote>
<div><p>An array of labels where 0 indicates the condition is met and 1 indicates the condition is not met.</p>
</div></blockquote>
<p>Raises:
- ValueError</p>
<blockquote>
<div><p>If the ‘physics’ key is not present in the metadata dictionary.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.label_management.crocus_method_three_labels">
<span class="sig-prename descclassname"><span class="pre">utils.label_management.</span></span><span class="sig-name descname"><span class="pre">crocus_method_three_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/label_management.html#crocus_method_three_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.label_management.crocus_method_three_labels" title="Permalink to this definition"></a></dt>
<dd><p>Apply the crocus method to label data based on specific conditions.</p>
<p>Parameters:
- metadata : dict</p>
<blockquote>
<div><p>A dictionary containing metadata. Must include a ‘physics’ key with corresponding data.</p>
</div></blockquote>
<p>Returns:
- labels : ndarray</p>
<blockquote>
<div><p>An array of labels where:
- “wet” indicates Condition A is met,
- “kinda_wet” indicates Condition B is met,
- “not_wet” indicates neither condition is met.</p>
</div></blockquote>
<p>Raises:
- ValueError</p>
<blockquote>
<div><p>If the ‘physics’ key is not present in the metadata dictionary.</p>
</div></blockquote>
</dd></dl>

</section>
</section>
<section id="module-utils.metrics">
<span id="utils-metrics-module"></span><h2>utils.metrics module<a class="headerlink" href="#module-utils.metrics" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="utils.metrics.BAROC">
<span class="sig-prename descclassname"><span class="pre">utils.metrics.</span></span><span class="sig-name descname"><span class="pre">BAROC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_est</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/metrics.html#BAROC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.metrics.BAROC" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the best threshold given the best accuracy based on the ROC curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.array</em>) – True labels</p></li>
<li><p><strong>y_est</strong> (<em>np.array</em>) – Estimated labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>float</em> – Best accuracy</p></li>
<li><p><em>float</em> – Best threshold</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.metrics.BF1ROC">
<span class="sig-prename descclassname"><span class="pre">utils.metrics.</span></span><span class="sig-name descname"><span class="pre">BF1ROC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_est</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/metrics.html#BF1ROC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.metrics.BF1ROC" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the best threshold given the best F1 score based on the ROC curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.array</em>) – True labels</p></li>
<li><p><strong>y_est</strong> (<em>np.array</em>) – Estimated labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>float</em> – Best F1 score</p></li>
<li><p><em>float</em> – Best threshold</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.metrics.FRCROC">
<span class="sig-prename descclassname"><span class="pre">utils.metrics.</span></span><span class="sig-name descname"><span class="pre">FRCROC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_est</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/metrics.html#FRCROC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.metrics.FRCROC" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the best threshold given a fixed FPR (False Positive Rate) based on the ROC curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.array</em>) – True labels</p></li>
<li><p><strong>y_est</strong> (<em>np.array</em>) – Estimated labels</p></li>
<li><p><strong>rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Fixed FPR, by default 0.05</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>float</em> – accuracy at the fixed FPR</p></li>
<li><p><em>float</em> – threshold at the fixed FPR</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-utils" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="evaluation.html" class="btn btn-neutral float-left" title="evaluation package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, cortesmc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>